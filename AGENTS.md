# F1 2026 Fan Hub — Agent Context

This file gives AI coding assistants immediate context about the project so sessions
can resume without re-explaining the setup.

---

## What this project is

A **fictitious F1 2026 fan site** built as a hands-on Firebase learning project.
It is **not** affiliated with Formula 1. The goal is to learn:

- Firebase Hosting (static SPA deployment)
- Cloud Firestore (real-time database + security rules)
- Firebase Auth (Google Sign-In)
- Firebase Storage (driver illustration images)
- Firestore Security Rules

---

## Tech stack

| Layer         | Technology                                              |
|---------------|---------------------------------------------------------|
| Frontend      | React 19 + Vite                                         |
| Styling       | Vanilla CSS — dark F1 theme, accent `#e10600`           |
| Database      | Cloud Firestore                                         |
| Auth          | Firebase Auth — Google Sign-In only                     |
| Storage       | Firebase Storage — driver illustrations                 |
| Hosting       | Firebase Hosting                                        |
| Illustrations | Gemini 2.0 Flash image generation (comic/manga style)   |

---

## Firebase project

- **Project ID**: `f1-fan-hub-b9098` (Blaze pay-as-you-go plan)
- **Firebase CLI alias**: configured in `.firebaserc`
- **Firestore region**: `nam5` (us-central)

---

## Live URLs

- **Primary**: https://f1.vanemmerik.ai (custom domain via Cloudflare DNS → Firebase Hosting)
- **Firebase default**: https://f1-fan-hub-b9098.web.app

---

## Repository

https://github.com/mvanemmerik/f1-hub

---

## Local project path

`/Users/monty/Desktop/f1-fan-hub`

---

## Data

All seeded via `scripts/seed.js` using Firebase Admin SDK:

- **22 drivers** — all official 2026 F1 grid (sourced from formula1.com)
- **11 teams** — all 2026 constructors
- **24 races** — full 2026 calendar

Driver illustrations are comic/manga-style images generated by Gemini and stored in
Firebase Storage. Each driver document in Firestore has a `photoUrl` field pointing
to the Storage URL.

---

## Key files

```
.env                          # Firebase + Gemini API keys — gitignored, NEVER commit
.env.example                  # Template — safe to commit (blank values)
.firebaserc                   # Firebase project alias
firebase.json                 # Hosting + Firestore + Storage config
firestore.rules               # Firestore Security Rules
firestore.indexes.json        # Composite indexes
storage.rules                 # Firebase Storage Security Rules
scripts/seed.js               # Seeds Firestore with all 2026 F1 data
scripts/generate-illustrations.js  # Gemini AI illustration generator
scripts/serviceAccountKey.json     # Firebase Admin key — gitignored, NEVER commit
src/firebase/firebase.js      # Firebase app init
src/firebase/auth.js          # Google sign-in / sign-out
src/firebase/firestore.js     # All Firestore queries + real-time listeners
src/context/AuthContext.jsx   # Global auth state (useAuth hook)
src/components/Navbar.jsx     # Sticky nav + hamburger mobile menu
src/components/CommentSection.jsx  # Real-time comments via onSnapshot
src/components/ProtectedRoute.jsx  # Client-side auth guard
src/pages/Predictions.jsx     # Pick race winners — auth required
src/pages/Profile.jsx         # Prediction history — auth required
```

---

## Deployment workflow

```bash
npm run build          # Vite production build → dist/
firebase deploy --only hosting   # Deploy dist/ to Firebase Hosting
```

To also deploy Firestore rules / indexes / Storage rules:

```bash
firebase deploy        # deploys everything (hosting + rules + indexes)
```

---

## Important discoveries / gotchas

- Firebase web API keys are **not secret** — security is enforced server-side by Firestore Security Rules
- The Admin SDK (used in scripts) **bypasses all security rules** — only run locally with the service account key
- `rss2json.com` free tier does not support the `count` parameter — omit it to get 10 items
- Firebase Storage requires the Blaze (pay-as-you-go) plan
- Firestore composite indexes are required for multi-field queries (e.g. `where` + `orderBy` on different fields)
- `onAuthStateChanged` fires immediately on page load — wait for it before rendering to avoid a flash of logged-out UI
- Change illustration filenames to bust Firebase Storage / browser cache
- `.firebase/` CLI cache directory is gitignored

---

## Coding conventions

- Inline comments explaining the **why** in every file — this is a learning project
- All CSS in `src/index.css` — no CSS framework
- No TypeScript — plain JSX throughout
- Secrets always via `import.meta.env.VITE_*` (Vite env vars) — never hardcoded
