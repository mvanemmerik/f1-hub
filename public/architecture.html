<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>F1 2026 Fan Hub â€” Architecture</title>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: #0f0f0f;
      color: #f0f0f0;
      font-family: 'Inter', system-ui, sans-serif;
      min-height: 100vh;
      padding: 2rem;
    }

    header {
      text-align: center;
      margin-bottom: 2.5rem;
    }
    header h1 {
      font-size: 1.6rem;
      font-weight: 900;
      letter-spacing: -.02em;
    }
    header h1 span { color: #e10600; }
    header p {
      color: #888;
      font-size: .9rem;
      margin-top: .4rem;
    }

    .diagram-wrap {
      background: #141414;
      border: 1px solid #2e2e2e;
      border-radius: 12px;
      padding: 2rem;
      max-width: 1300px;
      margin: 0 auto 3rem;
      overflow-x: auto;
    }

    /* â”€â”€ Legend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      max-width: 1300px;
      margin: 0 auto 3rem;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: .5rem;
      font-size: .82rem;
      color: #aaa;
    }
    .legend-dot {
      width: 14px; height: 14px;
      border-radius: 3px;
      flex-shrink: 0;
    }

    /* â”€â”€ Data flow table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .flows {
      max-width: 1300px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 1rem;
    }
    .flow-card {
      background: #141414;
      border: 1px solid #2e2e2e;
      border-radius: 10px;
      padding: 1.25rem 1.5rem;
    }
    .flow-card h3 {
      font-size: .8rem;
      font-weight: 700;
      letter-spacing: .08em;
      text-transform: uppercase;
      color: #555;
      margin-bottom: .85rem;
    }
    .flow-row {
      display: flex;
      align-items: flex-start;
      gap: .75rem;
      margin-bottom: .6rem;
      font-size: .85rem;
      line-height: 1.4;
    }
    .flow-arrow { color: #e10600; font-weight: 700; flex-shrink: 0; margin-top: 1px; }
    .flow-desc  { color: #aaa; }
    .flow-desc strong { color: #f0f0f0; }

    footer {
      text-align: center;
      color: #444;
      font-size: .78rem;
      margin-top: 3rem;
    }

    /* Force Mermaid dark */
    .mermaid svg { max-width: 100%; height: auto; }
  </style>
</head>
<body>

<header>
  <h1>ğŸ F1 <span>2026</span> Fan Hub â€” System Architecture</h1>
  <p>End-to-end data flow: from DNS to Firestore to the user's browser</p>
</header>

<!-- â”€â”€ Mermaid Diagram â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="diagram-wrap">
  <div class="mermaid">
%%{init: {
  "theme": "dark",
  "themeVariables": {
    "background":        "#141414",
    "primaryColor":      "#1e1e1e",
    "primaryTextColor":  "#f0f0f0",
    "primaryBorderColor":"#3a3a3a",
    "lineColor":         "#555555",
    "secondaryColor":    "#1a1a2e",
    "tertiaryColor":     "#1a2e1a",
    "edgeLabelBackground":"#0f0f0f",
    "clusterBkg":        "#161616",
    "clusterBorder":     "#2e2e2e",
    "titleColor":        "#f0f0f0",
    "fontFamily":        "Inter, system-ui, sans-serif"
  }
}}%%

flowchart TB

  %% â”€â”€ User â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  subgraph USER["  ğŸ‘¤  End User  "]
    Browser["ğŸŒ  Browser\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nf1.vanemmerik.ai"]
    ChatUI["ğŸ’¬  Chatbot UI\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nChatBot.jsx\nShort-term memory"]
  end

  %% â”€â”€ DNS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  subgraph CDN_LAYER["  ğŸŒ  Cloudflare  "]
    CF["DNS\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nf1.vanemmerik.ai\nâ†’ Firebase Hosting\n(DNS-only, grey cloud)"]
  end

  %% â”€â”€ Firebase / GCP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  subgraph FIREBASE["  ğŸ”¥  Firebase â€” GCP  "]
    Hosting["ğŸ“¦  Firebase Hosting\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nCDN edge nodes\nServes React SPA\n(dist/ folder)"]
    Auth["ğŸ”  Firebase Auth\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nGoogle Sign-In\nSession management\nAuthorized domains"]
    Firestore["ğŸ—„ï¸  Firestore\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n/drivers      (public)\n/teams        (public)\n/races        (public)\n/results      (auth read)\n/standings    (auth read)\n/users        (owner)\n  â”” chatMemory\n/comments     (auth)\n/predictions  (auth)"]
    Storage["ğŸ–¼ï¸  Firebase Storage\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n/driver-illustrations\n22 Ã— AI-generated\nPNG portraits"]
    Scheduler["â°  Cloud Scheduler\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nCron: 0 6 * * *\nTriggers syncF1Data\ndaily at 06:00 UTC"]
    Functions["âš¡  Cloud Functions\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nsyncF1Data (Gen 2)\nFetches Jolpica API\nWrites results +\nstandings to Firestore\n\naskF1Expert (Gen 2)\nGemini chat +\nGoogle Search grounding"]
  end

  %% â”€â”€ External â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  subgraph EXTERNAL["  ğŸŒ  External Services  "]
    GoogleOAuth["ğŸ”µ  Google OAuth 2.0\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nSign-in popup\nID token â†’ Firebase"]
    JolpicaAPI["ğŸï¸  Jolpica F1 API\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\napi.jolpi.ca\nRace results\nDriver standings\nConstructor standings\n(free, no key)"]
    rss2json["âš™ï¸  rss2json.com\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nCORS proxy\nRSS â†’ JSON"]
    Motorsport["ğŸ“°  Motorsport.com\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nF1 RSS feed\n(live news)"]
    Gemini["âœ¨  Gemini API\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\ngemini-2.0-flash\nChat + grounding\nComic/manga portraits"]
  end

  %% â”€â”€ Developer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  subgraph DEV["  ğŸ’»  Developer Toolchain  "]
    GitHub["ğŸ™  GitHub\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nmvanemmerik/f1-hub\nSource of truth"]
    CLI["âš¡  Firebase CLI\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nnpm run build\nfirebase deploy"]
    Scripts["ğŸ“œ  Admin Scripts\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nseed.js\ngenerate-illustrations.js\nupdate-photos.js\n(Admin SDK â€” bypasses rules)"]
  end

  %% â”€â”€ Edges: User flow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Browser      -->|"DNS lookup"| CF
  CF           -->|"CNAME â†’ Firebase"| Hosting
  Hosting      -->|"Serves index.html + JS"| Browser

  Browser      -->|"Sign in with Google"| Auth
  Auth         -->|"OAuth popup"| GoogleOAuth
  GoogleOAuth  -->|"ID token"| Auth
  Auth         -->|"Auth state"| Browser

  Browser      -->|"Read drivers/teams/races\nresults/standings (auth)"| Firestore
  Browser      -->|"Write comments/predictions\n(auth + rules)"| Firestore
  Browser      -->|"Load illustrations\n(public read)"| Storage

  Browser      -->|"Open chatbot"| ChatUI
  ChatUI       -->|"Load/save chatMemory\n(users/{uid})"| Firestore
  ChatUI       -->|"POST /api/askF1Expert\n(Bearer token)"| Hosting
  Hosting      -->|"Rewrite to\naskF1Expert"| Functions
  Functions    -->|"Gemini chat +\nGoogle Search"| Gemini

  Browser      -->|"Fetch news (CORS)"| rss2json
  rss2json     -->|"Proxy RSS fetch"| Motorsport

  %% â”€â”€ Edges: Automated sync â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Scheduler    -->|"Trigger daily\n06:00 UTC"| Functions
  Functions    -->|"GET /last/results\nGET /driverStandings\nGET /constructorStandings"| JolpicaAPI
  JolpicaAPI   -->|"Race results + standings\nJSON response"| Functions
  Functions    -->|"Batch write\nresults + standings\n(Admin SDK)"| Firestore

  %% â”€â”€ Edges: Dev/deploy flow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GitHub       -->|"git push"| CLI
  CLI          -->|"firebase deploy\n--only hosting"| Hosting
  CLI          -->|"firebase deploy\n--only firestore"| Firestore
  CLI          -->|"firebase deploy\n--only functions"| Functions

  Scripts      -->|"Gemini image gen\n(22 drivers)"| Gemini
  Gemini       -->|"base64 PNG"| Scripts
  Scripts      -->|"Upload illustrations\n(Admin SDK)"| Storage
  Scripts      -->|"Seed & update\nFirestore docs"| Firestore

  %% â”€â”€ Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  style Browser     fill:#1a1a2e,stroke:#4444aa,color:#f0f0f0
  style ChatUI      fill:#1a1a2e,stroke:#4444aa,color:#f0f0f0
  style CF          fill:#1a1a1a,stroke:#f6821f,color:#f6821f

  style Hosting     fill:#1a2e1a,stroke:#34a853,color:#f0f0f0
  style Auth        fill:#1a2e1a,stroke:#34a853,color:#f0f0f0
  style Firestore   fill:#1a2e1a,stroke:#34a853,color:#f0f0f0
  style Storage     fill:#1a2e1a,stroke:#34a853,color:#f0f0f0
  style Scheduler   fill:#1a2e1a,stroke:#34a853,color:#f0f0f0
  style Functions   fill:#2a1a1a,stroke:#e10600,color:#f0f0f0

  style GoogleOAuth fill:#1a1a2e,stroke:#4285f4,color:#f0f0f0
  style JolpicaAPI  fill:#1e1e1e,stroke:#888888,color:#f0f0f0
  style rss2json    fill:#1e1e1e,stroke:#555555,color:#f0f0f0
  style Motorsport  fill:#1e1e1e,stroke:#555555,color:#f0f0f0
  style Gemini      fill:#1a2030,stroke:#8ab4f8,color:#f0f0f0

  style GitHub      fill:#1e1e1e,stroke:#6e40c9,color:#f0f0f0
  style CLI         fill:#1e1e1e,stroke:#6e40c9,color:#f0f0f0
  style Scripts     fill:#1e1e1e,stroke:#6e40c9,color:#f0f0f0
  </div>
</div>

<!-- â”€â”€ Legend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="legend">
  <div class="legend-item"><div class="legend-dot" style="background:#4444aa"></div> Browser / Client</div>
  <div class="legend-item"><div class="legend-dot" style="background:#f6821f"></div> Cloudflare DNS</div>
  <div class="legend-item"><div class="legend-dot" style="background:#34a853"></div> Firebase / GCP Services</div>
  <div class="legend-item"><div class="legend-dot" style="background:#e10600"></div> Cloud Functions</div>
  <div class="legend-item"><div class="legend-dot" style="background:#4285f4"></div> Google OAuth</div>
  <div class="legend-item"><div class="legend-dot" style="background:#8ab4f8"></div> Gemini AI</div>
  <div class="legend-item"><div class="legend-dot" style="background:#6e40c9"></div> Developer Toolchain</div>
  <div class="legend-item"><div class="legend-dot" style="background:#888"></div> External APIs</div>
</div>

<!-- â”€â”€ Data flow breakdown â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="flows">

  <div class="flow-card">
    <h3>ğŸŒ Page Load</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Browser resolves <strong>f1.vanemmerik.ai</strong> via Cloudflare DNS</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Cloudflare CNAME points to <strong>Firebase Hosting CDN</strong></span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Firebase serves <strong>index.html + React bundle</strong> from CDN edge node</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">React app boots, <strong>onAuthStateChanged</strong> checks for existing session</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">If no session, <strong>login wall</strong> renders â€” nothing else loads until sign-in</span></div>
  </div>

  <div class="flow-card">
    <h3>ğŸ” Authentication</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">User clicks <strong>Sign in with Google</strong> on the login wall</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Firebase Auth opens <strong>Google OAuth popup</strong></span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Google returns <strong>ID token</strong> to Firebase Auth</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Firebase validates token, creates <strong>session</strong> + user doc in Firestore</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>AuthContext</strong> propagates user state â€” full app renders</span></div>
  </div>

  <div class="flow-card">
    <h3>ğŸ—„ï¸ Database Reads</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>getDocs()</strong> fetches drivers, teams, races â€” Security Rules: <code>allow read: if true</code></span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>getDoc()</strong> fetches standings/drivers and standings/constructors â€” requires auth</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>getRaceResult()</strong> fetches results/{year_round} â€” requires auth</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Comments use <strong>onSnapshot()</strong> â€” real-time listener, auto-updates UI</span></div>
  </div>

  <div class="flow-card">
    <h3>âœï¸ Database Writes (Auth-gated)</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">User posts comment or locks in prediction</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Client calls <strong>addDoc()</strong> with userId = request.auth.uid</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Firestore Security Rules validate: <strong>auth, ownership, field types, length</strong></span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Write accepted or rejected <strong>server-side</strong> â€” client code cannot override</span></div>
  </div>

  <div class="flow-card">
    <h3>âš¡ Automated Data Sync (new)</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>Cloud Scheduler</strong> fires cron trigger daily at 06:00 UTC</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>syncF1Data</strong> Cloud Function (Gen 2 / Node.js 20) wakes up</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Calls <strong>Jolpica F1 API</strong> in parallel: latest race results + driver standings + constructor standings</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Writes to Firestore <strong>atomically via batch commit</strong> (Admin SDK bypasses rules)</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Standings page + Race Detail page read fresh data on next visit</span></div>
  </div>

  <div class="flow-card">
    <h3>ğŸ“° News Feed</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Browser cannot fetch Motorsport.com RSS directly (CORS blocked)</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">App fetches <strong>rss2json.com</strong> proxy instead â€” returns clean JSON</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">rss2json fetches <strong>Motorsport.com RSS</strong> server-side and proxies result</span></div>
  </div>

  <div class="flow-card">
    <h3>ğŸ’¬ Chatbot (AI)</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">User opens <strong>F1 Expert</strong> chat overlay</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Chat UI loads <strong>chatMemory</strong> from users/{uid}</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Client sends prompt to <strong>/api/askF1Expert</strong> (Bearer token)</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Cloud Function calls <strong>Gemini 2.0 Flash</strong> with Google Search grounding</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Reply + citations returned; <strong>chatMemory</strong> saved back to Firestore</span></div>
  </div>

  <div class="flow-card">
    <h3>âœ¨ AI Illustration Pipeline (offline)</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>generate-illustrations.js</strong> runs locally with Admin SDK</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Sends text prompt (+ optional photo) to <strong>Gemini 2.0 Flash</strong></span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Gemini returns <strong>base64 PNG</strong> comic/manga illustration</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">PNG uploaded to <strong>Firebase Storage</strong>, made public</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc">Public URL written to <strong>Firestore driver document</strong></span></div>
  </div>

  <div class="flow-card">
    <h3>ğŸš€ Deployment</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>git push</strong> to GitHub (source of truth)</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>npm run build</strong> â€” Vite bundles React into dist/</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>firebase deploy --only hosting</strong> â€” pushes dist/ to Hosting CDN</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>firebase deploy --only functions</strong> â€” builds + deploys Cloud Function via Cloud Build</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>firebase deploy --only firestore</strong> â€” updates Security Rules + indexes</span></div>
  </div>

  <div class="flow-card">
    <h3>ğŸ”’ Security Layers</h3>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>Login wall:</strong> entire app gated â€” no routes render without a signed-in user</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>Client-side:</strong> ProtectedRoute guards Predictions + Profile pages</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>Server-side:</strong> Firestore Security Rules â€” cannot be bypassed by any client</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>results + standings:</strong> written only by Cloud Function (Admin SDK) â€” no client write</span></div>
    <div class="flow-row"><span class="flow-arrow">â†’</span><span class="flow-desc"><strong>Secrets:</strong> .env and serviceAccountKey.json â€” gitignored, never in repo</span></div>
  </div>

</div>

<footer>F1 2026 Fan Hub Â· Built with OpenCode Â· Firebase + React + Gemini AI + Cloud Functions</footer>

<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark',
    flowchart: { useMaxWidth: true, htmlLabels: true, curve: 'basis' },
  });
</script>
</body>
</html>
